export default function imageViewer(){let r=!1,a=1,i=!1,o=!1,s=0,c=0,l=0,d=0,u=0;const t=document.querySelector(".image-viewer-container");if(!t)return void console.warn("Image viewer container not found. Exiting imageViewer function.");const m=t.querySelector("img");if(!m)return void console.warn("Target image not found in image viewer container. Exiting imageViewer function.");const n=e=>{document.body.style.overflow=e?"hidden":"auto",e?t.classList.add("active"):t.classList.remove("active")};let v=0;const e=e=>{i&&e.stopPropagation(),i=!1,m.style.cursor="grab"};m.addEventListener("wheel",e=>{e.preventDefault();const t=m.getBoundingClientRect(),n=e.clientX-t.left,r=e.clientY-t.top,i=n-t.width/2,o=r-t.height/2,s=a;a+=-.001*e.deltaY,a=Math.min(Math.max(.8,a),4),s<a?(d-=i*(a-s),u-=o*(a-s)):(d=0,u=0),m.style.transform=`translate(${d}px, ${u}px) scale(${a})`},{passive:!1}),m.addEventListener("mousedown",e=>{e.preventDefault(),i=!0,c=e.clientX,l=e.clientY,m.style.cursor="grabbing"},{passive:!1}),m.addEventListener("mousemove",n=>{if(i){const i=(new Date).getTime();if(i-v<100)return;v=i;const e=n.clientX-c,t=n.clientY-l;d+=e,u+=t,c=n.clientX,l=n.clientY,m.style.transform=`translate(${d}px, ${u}px) scale(${a})`,o=!0}},{passive:!1}),m.addEventListener("mouseup",e,{passive:!1}),m.addEventListener("mouseleave",e,{passive:!1}),t.addEventListener("click",e=>{o||(r=!1,n(r),a=1,d=0,u=0,m.style.transform=`translate(${d}px, ${u}px) scale(${a})`),o=!1});const g=document.querySelectorAll(".markdown-body img, .masonry-item img, #shuoshuo-content img"),f=e=>{"Escape"===e.key&&r&&(r=!1,n(r),a=1,d=0,u=0,m.style.transform=`translate(${d}px, ${u}px) scale(${a})`,document.removeEventListener("keydown",f))};if(g.length>0){g.forEach((e,t)=>{e.addEventListener("click",()=>{s=t,r=!0,n(r),m.src=e.src,document.addEventListener("keydown",f)})});const y=e=>{if(!r)return;if("ArrowUp"===e.key||"ArrowLeft"===e.key)s=(s-1+g.length)%g.length;else{if("ArrowDown"!==e.key&&"ArrowRight"!==e.key)return;s=(s+1)%g.length}const t=g[s];let n=t.src;t.hasAttribute("lazyload")&&(n=t.getAttribute("data-src"),t.src=n,t.removeAttribute("lazyload")),m.src=n};document.addEventListener("keydown",y)}}